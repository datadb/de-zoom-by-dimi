{"payload":{"allShortcutsEnabled":false,"fileTree":{"05-batch/code":{"items":[{"name":"03_test.ipynb","path":"05-batch/code/03_test.ipynb","contentType":"file"},{"name":"04_pyspark.ipynb","path":"05-batch/code/04_pyspark.ipynb","contentType":"file"},{"name":"05_taxi_schema.ipynb","path":"05-batch/code/05_taxi_schema.ipynb","contentType":"file"},{"name":"06_spark_sql.ipynb","path":"05-batch/code/06_spark_sql.ipynb","contentType":"file"},{"name":"06_spark_sql.py","path":"05-batch/code/06_spark_sql.py","contentType":"file"},{"name":"06_spark_sql_big_query.py","path":"05-batch/code/06_spark_sql_big_query.py","contentType":"file"},{"name":"07_groupby_join.ipynb","path":"05-batch/code/07_groupby_join.ipynb","contentType":"file"},{"name":"08_rdds.ipynb","path":"05-batch/code/08_rdds.ipynb","contentType":"file"},{"name":"09_spark_gcs.ipynb","path":"05-batch/code/09_spark_gcs.ipynb","contentType":"file"},{"name":"cloud.md","path":"05-batch/code/cloud.md","contentType":"file"},{"name":"download_data.sh","path":"05-batch/code/download_data.sh","contentType":"file"},{"name":"homework.ipynb","path":"05-batch/code/homework.ipynb","contentType":"file"}],"totalCount":12},"05-batch":{"items":[{"name":"code","path":"05-batch/code","contentType":"directory"},{"name":"setup","path":"05-batch/setup","contentType":"directory"},{"name":".gitignore","path":"05-batch/.gitignore","contentType":"file"},{"name":"README.md","path":"05-batch/README.md","contentType":"file"}],"totalCount":4},"":{"items":[{"name":".devcontainer","path":".devcontainer","contentType":"directory"},{"name":"01-docker-terraform","path":"01-docker-terraform","contentType":"directory"},{"name":"02-workflow-orchestration","path":"02-workflow-orchestration","contentType":"directory"},{"name":"03-data-warehouse","path":"03-data-warehouse","contentType":"directory"},{"name":"04-analytics-engineering","path":"04-analytics-engineering","contentType":"directory"},{"name":"05-batch","path":"05-batch","contentType":"directory"},{"name":"06-streaming","path":"06-streaming","contentType":"directory"},{"name":"cohorts","path":"cohorts","contentType":"directory"},{"name":"images","path":"images","contentType":"directory"},{"name":"projects","path":"projects","contentType":"directory"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"after-sign-up.md","path":"after-sign-up.md","contentType":"file"},{"name":"asking-questions.md","path":"asking-questions.md","contentType":"file"},{"name":"cerficates.md","path":"cerficates.md","contentType":"file"},{"name":"dataset.md","path":"dataset.md","contentType":"file"}],"totalCount":16}},"fileTreeProcessingTime":6.142095,"foldersToFetch":[],"repo":{"id":419661684,"defaultBranch":"main","name":"data-engineering-zoomcamp","ownerLogin":"DataTalksClub","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2021-10-21T09:32:50.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/72699292?v=4","public":true,"private":false,"isOrgOwned":true},"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"main","listCacheKey":"v0:1709070902.0","canEdit":false,"refType":"branch","currentOid":"7caa2ff237af5dd95831bf07320ad708cde463ce"},"path":"05-batch/code/06_spark_sql_big_query.py","currentUser":null,"blob":{"rawLines":["#!/usr/bin/env python","# coding: utf-8","","import argparse","","import pyspark","from pyspark.sql import SparkSession","from pyspark.sql import functions as F","","","parser = argparse.ArgumentParser()","","parser.add_argument('--input_green', required=True)","parser.add_argument('--input_yellow', required=True)","parser.add_argument('--output', required=True)","","args = parser.parse_args()","","input_green = args.input_green","input_yellow = args.input_yellow","output = args.output","","","spark = SparkSession.builder \\","    .appName('test') \\","    .getOrCreate()","","spark.conf.set('temporaryGcsBucket', 'dataproc-temp-europe-west6-828225226997-fckhkym8')","","df_green = spark.read.parquet(input_green)","","df_green = df_green \\","    .withColumnRenamed('lpep_pickup_datetime', 'pickup_datetime') \\","    .withColumnRenamed('lpep_dropoff_datetime', 'dropoff_datetime')","","df_yellow = spark.read.parquet(input_yellow)","","","df_yellow = df_yellow \\","    .withColumnRenamed('tpep_pickup_datetime', 'pickup_datetime') \\","    .withColumnRenamed('tpep_dropoff_datetime', 'dropoff_datetime')","","","common_colums = [","    'VendorID',","    'pickup_datetime',","    'dropoff_datetime',","    'store_and_fwd_flag',","    'RatecodeID',","    'PULocationID',","    'DOLocationID',","    'passenger_count',","    'trip_distance',","    'fare_amount',","    'extra',","    'mta_tax',","    'tip_amount',","    'tolls_amount',","    'improvement_surcharge',","    'total_amount',","    'payment_type',","    'congestion_surcharge'","]","","","","df_green_sel = df_green \\","    .select(common_colums) \\","    .withColumn('service_type', F.lit('green'))","","df_yellow_sel = df_yellow \\","    .select(common_colums) \\","    .withColumn('service_type', F.lit('yellow'))","","","df_trips_data = df_green_sel.unionAll(df_yellow_sel)","","df_trips_data.registerTempTable('trips_data')","","","df_result = spark.sql(\"\"\"","SELECT ","    -- Reveneue grouping ","    PULocationID AS revenue_zone,","    date_trunc('month', pickup_datetime) AS revenue_month, ","    service_type, ","","    -- Revenue calculation ","    SUM(fare_amount) AS revenue_monthly_fare,","    SUM(extra) AS revenue_monthly_extra,","    SUM(mta_tax) AS revenue_monthly_mta_tax,","    SUM(tip_amount) AS revenue_monthly_tip_amount,","    SUM(tolls_amount) AS revenue_monthly_tolls_amount,","    SUM(improvement_surcharge) AS revenue_monthly_improvement_surcharge,","    SUM(total_amount) AS revenue_monthly_total_amount,","    SUM(congestion_surcharge) AS revenue_monthly_congestion_surcharge,","","    -- Additional calculations","    AVG(passenger_count) AS avg_montly_passenger_count,","    AVG(trip_distance) AS avg_montly_trip_distance","FROM","    trips_data","GROUP BY","    1, 2, 3","\"\"\")","","","df_result.write.format('bigquery') \\","    .option('table', output) \\","    .save()","    "],"stylingDirectives":[[{"start":0,"end":21,"cssClass":"pl-c"}],[{"start":0,"end":15,"cssClass":"pl-c"}],[],[{"start":0,"end":6,"cssClass":"pl-k"},{"start":7,"end":15,"cssClass":"pl-s1"}],[],[{"start":0,"end":6,"cssClass":"pl-k"},{"start":7,"end":14,"cssClass":"pl-s1"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":12,"cssClass":"pl-s1"},{"start":13,"end":16,"cssClass":"pl-s1"},{"start":17,"end":23,"cssClass":"pl-k"},{"start":24,"end":36,"cssClass":"pl-v"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":12,"cssClass":"pl-s1"},{"start":13,"end":16,"cssClass":"pl-s1"},{"start":17,"end":23,"cssClass":"pl-k"},{"start":24,"end":33,"cssClass":"pl-s1"},{"start":34,"end":36,"cssClass":"pl-k"},{"start":37,"end":38,"cssClass":"pl-v"}],[],[],[{"start":0,"end":6,"cssClass":"pl-s1"},{"start":7,"end":8,"cssClass":"pl-c1"},{"start":9,"end":17,"cssClass":"pl-s1"},{"start":18,"end":32,"cssClass":"pl-v"}],[],[{"start":0,"end":6,"cssClass":"pl-s1"},{"start":7,"end":19,"cssClass":"pl-en"},{"start":20,"end":35,"cssClass":"pl-s"},{"start":37,"end":45,"cssClass":"pl-s1"},{"start":45,"end":46,"cssClass":"pl-c1"},{"start":46,"end":50,"cssClass":"pl-c1"}],[{"start":0,"end":6,"cssClass":"pl-s1"},{"start":7,"end":19,"cssClass":"pl-en"},{"start":20,"end":36,"cssClass":"pl-s"},{"start":38,"end":46,"cssClass":"pl-s1"},{"start":46,"end":47,"cssClass":"pl-c1"},{"start":47,"end":51,"cssClass":"pl-c1"}],[{"start":0,"end":6,"cssClass":"pl-s1"},{"start":7,"end":19,"cssClass":"pl-en"},{"start":20,"end":30,"cssClass":"pl-s"},{"start":32,"end":40,"cssClass":"pl-s1"},{"start":40,"end":41,"cssClass":"pl-c1"},{"start":41,"end":45,"cssClass":"pl-c1"}],[],[{"start":0,"end":4,"cssClass":"pl-s1"},{"start":5,"end":6,"cssClass":"pl-c1"},{"start":7,"end":13,"cssClass":"pl-s1"},{"start":14,"end":24,"cssClass":"pl-en"}],[],[{"start":0,"end":11,"cssClass":"pl-s1"},{"start":12,"end":13,"cssClass":"pl-c1"},{"start":14,"end":18,"cssClass":"pl-s1"},{"start":19,"end":30,"cssClass":"pl-s1"}],[{"start":0,"end":12,"cssClass":"pl-s1"},{"start":13,"end":14,"cssClass":"pl-c1"},{"start":15,"end":19,"cssClass":"pl-s1"},{"start":20,"end":32,"cssClass":"pl-s1"}],[{"start":0,"end":6,"cssClass":"pl-s1"},{"start":7,"end":8,"cssClass":"pl-c1"},{"start":9,"end":13,"cssClass":"pl-s1"},{"start":14,"end":20,"cssClass":"pl-s1"}],[],[],[{"start":0,"end":5,"cssClass":"pl-s1"},{"start":6,"end":7,"cssClass":"pl-c1"},{"start":8,"end":20,"cssClass":"pl-v"},{"start":21,"end":28,"cssClass":"pl-s1"}],[{"start":5,"end":12,"cssClass":"pl-en"},{"start":13,"end":19,"cssClass":"pl-s"}],[{"start":5,"end":16,"cssClass":"pl-en"}],[],[{"start":0,"end":5,"cssClass":"pl-s1"},{"start":6,"end":10,"cssClass":"pl-s1"},{"start":11,"end":14,"cssClass":"pl-en"},{"start":15,"end":35,"cssClass":"pl-s"},{"start":37,"end":87,"cssClass":"pl-s"}],[],[{"start":0,"end":8,"cssClass":"pl-s1"},{"start":9,"end":10,"cssClass":"pl-c1"},{"start":11,"end":16,"cssClass":"pl-s1"},{"start":17,"end":21,"cssClass":"pl-s1"},{"start":22,"end":29,"cssClass":"pl-en"},{"start":30,"end":41,"cssClass":"pl-s1"}],[],[{"start":0,"end":8,"cssClass":"pl-s1"},{"start":9,"end":10,"cssClass":"pl-c1"},{"start":11,"end":19,"cssClass":"pl-s1"}],[{"start":5,"end":22,"cssClass":"pl-en"},{"start":23,"end":45,"cssClass":"pl-s"},{"start":47,"end":64,"cssClass":"pl-s"}],[{"start":5,"end":22,"cssClass":"pl-en"},{"start":23,"end":46,"cssClass":"pl-s"},{"start":48,"end":66,"cssClass":"pl-s"}],[],[{"start":0,"end":9,"cssClass":"pl-s1"},{"start":10,"end":11,"cssClass":"pl-c1"},{"start":12,"end":17,"cssClass":"pl-s1"},{"start":18,"end":22,"cssClass":"pl-s1"},{"start":23,"end":30,"cssClass":"pl-en"},{"start":31,"end":43,"cssClass":"pl-s1"}],[],[],[{"start":0,"end":9,"cssClass":"pl-s1"},{"start":10,"end":11,"cssClass":"pl-c1"},{"start":12,"end":21,"cssClass":"pl-s1"}],[{"start":5,"end":22,"cssClass":"pl-en"},{"start":23,"end":45,"cssClass":"pl-s"},{"start":47,"end":64,"cssClass":"pl-s"}],[{"start":5,"end":22,"cssClass":"pl-en"},{"start":23,"end":46,"cssClass":"pl-s"},{"start":48,"end":66,"cssClass":"pl-s"}],[],[],[{"start":0,"end":13,"cssClass":"pl-s1"},{"start":14,"end":15,"cssClass":"pl-c1"}],[{"start":4,"end":14,"cssClass":"pl-s"}],[{"start":4,"end":21,"cssClass":"pl-s"}],[{"start":4,"end":22,"cssClass":"pl-s"}],[{"start":4,"end":24,"cssClass":"pl-s"}],[{"start":4,"end":16,"cssClass":"pl-s"}],[{"start":4,"end":18,"cssClass":"pl-s"}],[{"start":4,"end":18,"cssClass":"pl-s"}],[{"start":4,"end":21,"cssClass":"pl-s"}],[{"start":4,"end":19,"cssClass":"pl-s"}],[{"start":4,"end":17,"cssClass":"pl-s"}],[{"start":4,"end":11,"cssClass":"pl-s"}],[{"start":4,"end":13,"cssClass":"pl-s"}],[{"start":4,"end":16,"cssClass":"pl-s"}],[{"start":4,"end":18,"cssClass":"pl-s"}],[{"start":4,"end":27,"cssClass":"pl-s"}],[{"start":4,"end":18,"cssClass":"pl-s"}],[{"start":4,"end":18,"cssClass":"pl-s"}],[{"start":4,"end":26,"cssClass":"pl-s"}],[],[],[],[],[{"start":0,"end":12,"cssClass":"pl-s1"},{"start":13,"end":14,"cssClass":"pl-c1"},{"start":15,"end":23,"cssClass":"pl-s1"}],[{"start":5,"end":11,"cssClass":"pl-en"},{"start":12,"end":25,"cssClass":"pl-s1"}],[{"start":5,"end":15,"cssClass":"pl-en"},{"start":16,"end":30,"cssClass":"pl-s"},{"start":32,"end":33,"cssClass":"pl-v"},{"start":34,"end":37,"cssClass":"pl-en"},{"start":38,"end":45,"cssClass":"pl-s"}],[],[{"start":0,"end":13,"cssClass":"pl-s1"},{"start":14,"end":15,"cssClass":"pl-c1"},{"start":16,"end":25,"cssClass":"pl-s1"}],[{"start":5,"end":11,"cssClass":"pl-en"},{"start":12,"end":25,"cssClass":"pl-s1"}],[{"start":5,"end":15,"cssClass":"pl-en"},{"start":16,"end":30,"cssClass":"pl-s"},{"start":32,"end":33,"cssClass":"pl-v"},{"start":34,"end":37,"cssClass":"pl-en"},{"start":38,"end":46,"cssClass":"pl-s"}],[],[],[{"start":0,"end":13,"cssClass":"pl-s1"},{"start":14,"end":15,"cssClass":"pl-c1"},{"start":16,"end":28,"cssClass":"pl-s1"},{"start":29,"end":37,"cssClass":"pl-en"},{"start":38,"end":51,"cssClass":"pl-s1"}],[],[{"start":0,"end":13,"cssClass":"pl-s1"},{"start":14,"end":31,"cssClass":"pl-en"},{"start":32,"end":44,"cssClass":"pl-s"}],[],[],[{"start":0,"end":9,"cssClass":"pl-s1"},{"start":10,"end":11,"cssClass":"pl-c1"},{"start":12,"end":17,"cssClass":"pl-s1"},{"start":18,"end":21,"cssClass":"pl-en"},{"start":22,"end":25,"cssClass":"pl-s"}],[{"start":0,"end":7,"cssClass":"pl-s"}],[{"start":0,"end":25,"cssClass":"pl-s"}],[{"start":0,"end":33,"cssClass":"pl-s"}],[{"start":0,"end":59,"cssClass":"pl-s"}],[{"start":0,"end":18,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":27,"cssClass":"pl-s"}],[{"start":0,"end":45,"cssClass":"pl-s"}],[{"start":0,"end":40,"cssClass":"pl-s"}],[{"start":0,"end":44,"cssClass":"pl-s"}],[{"start":0,"end":50,"cssClass":"pl-s"}],[{"start":0,"end":54,"cssClass":"pl-s"}],[{"start":0,"end":72,"cssClass":"pl-s"}],[{"start":0,"end":54,"cssClass":"pl-s"}],[{"start":0,"end":70,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":30,"cssClass":"pl-s"}],[{"start":0,"end":55,"cssClass":"pl-s"}],[{"start":0,"end":50,"cssClass":"pl-s"}],[{"start":0,"end":4,"cssClass":"pl-s"}],[{"start":0,"end":14,"cssClass":"pl-s"}],[{"start":0,"end":8,"cssClass":"pl-s"}],[{"start":0,"end":11,"cssClass":"pl-s"}],[{"start":0,"end":3,"cssClass":"pl-s"}],[],[],[{"start":0,"end":9,"cssClass":"pl-s1"},{"start":10,"end":15,"cssClass":"pl-s1"},{"start":16,"end":22,"cssClass":"pl-en"},{"start":23,"end":33,"cssClass":"pl-s"}],[{"start":5,"end":11,"cssClass":"pl-en"},{"start":12,"end":19,"cssClass":"pl-s"},{"start":21,"end":27,"cssClass":"pl-s1"}],[{"start":5,"end":9,"cssClass":"pl-en"}],[],[],[],[]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/DataTalksClub/data-engineering-zoomcamp/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null},"displayName":"06_spark_sql_big_query.py","displayUrl":"https://github.com/DataTalksClub/data-engineering-zoomcamp/blob/main/05-batch/code/06_spark_sql_big_query.py?raw=true","headerInfo":{"blobSize":"2.59 KB","deleteTooltip":"You must be signed in to make or propose changes","editTooltip":"You must be signed in to make or propose changes","ghDesktopPath":"https://desktop.github.com","isGitLfs":false,"onBranch":true,"shortPath":"3556f9e","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2FDataTalksClub%2Fdata-engineering-zoomcamp%2Fblob%2Fmain%2F05-batch%2Fcode%2F06_spark_sql_big_query.py","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"114","truncatedSloc":"80"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplate":null,"discussionTemplate":null,"language":"Python","languageID":303,"large":false,"planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/DataTalksClub/data-engineering-zoomcamp/blob/main/05-batch/code/06_spark_sql_big_query.py","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","releasePath":"/DataTalksClub/data-engineering-zoomcamp/releases/new?marketplace=true","showPublishActionBanner":false},"rawBlobUrl":"https://github.com/DataTalksClub/data-engineering-zoomcamp/raw/main/05-batch/code/06_spark_sql_big_query.py","renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timed_out":false,"not_analyzed":false,"symbols":[{"name":"parser","kind":"constant","ident_start":149,"ident_end":155,"extent_start":149,"extent_end":183,"fully_qualified_name":"parser","ident_utf16":{"start":{"line_number":10,"utf16_col":0},"end":{"line_number":10,"utf16_col":6}},"extent_utf16":{"start":{"line_number":10,"utf16_col":0},"end":{"line_number":10,"utf16_col":34}}},{"name":"args","kind":"constant","ident_start":338,"ident_end":342,"extent_start":338,"extent_end":364,"fully_qualified_name":"args","ident_utf16":{"start":{"line_number":16,"utf16_col":0},"end":{"line_number":16,"utf16_col":4}},"extent_utf16":{"start":{"line_number":16,"utf16_col":0},"end":{"line_number":16,"utf16_col":26}}},{"name":"input_green","kind":"constant","ident_start":366,"ident_end":377,"extent_start":366,"extent_end":396,"fully_qualified_name":"input_green","ident_utf16":{"start":{"line_number":18,"utf16_col":0},"end":{"line_number":18,"utf16_col":11}},"extent_utf16":{"start":{"line_number":18,"utf16_col":0},"end":{"line_number":18,"utf16_col":30}}},{"name":"input_yellow","kind":"constant","ident_start":397,"ident_end":409,"extent_start":397,"extent_end":429,"fully_qualified_name":"input_yellow","ident_utf16":{"start":{"line_number":19,"utf16_col":0},"end":{"line_number":19,"utf16_col":12}},"extent_utf16":{"start":{"line_number":19,"utf16_col":0},"end":{"line_number":19,"utf16_col":32}}},{"name":"output","kind":"constant","ident_start":430,"ident_end":436,"extent_start":430,"extent_end":450,"fully_qualified_name":"output","ident_utf16":{"start":{"line_number":20,"utf16_col":0},"end":{"line_number":20,"utf16_col":6}},"extent_utf16":{"start":{"line_number":20,"utf16_col":0},"end":{"line_number":20,"utf16_col":20}}},{"name":"spark","kind":"constant","ident_start":453,"ident_end":458,"extent_start":453,"extent_end":525,"fully_qualified_name":"spark","ident_utf16":{"start":{"line_number":23,"utf16_col":0},"end":{"line_number":23,"utf16_col":5}},"extent_utf16":{"start":{"line_number":23,"utf16_col":0},"end":{"line_number":25,"utf16_col":18}}},{"name":"df_green","kind":"constant","ident_start":617,"ident_end":625,"extent_start":617,"extent_end":659,"fully_qualified_name":"df_green","ident_utf16":{"start":{"line_number":29,"utf16_col":0},"end":{"line_number":29,"utf16_col":8}},"extent_utf16":{"start":{"line_number":29,"utf16_col":0},"end":{"line_number":29,"utf16_col":42}}},{"name":"df_green","kind":"constant","ident_start":661,"ident_end":669,"extent_start":661,"extent_end":818,"fully_qualified_name":"df_green","ident_utf16":{"start":{"line_number":31,"utf16_col":0},"end":{"line_number":31,"utf16_col":8}},"extent_utf16":{"start":{"line_number":31,"utf16_col":0},"end":{"line_number":33,"utf16_col":67}}},{"name":"df_yellow","kind":"constant","ident_start":820,"ident_end":829,"extent_start":820,"extent_end":864,"fully_qualified_name":"df_yellow","ident_utf16":{"start":{"line_number":35,"utf16_col":0},"end":{"line_number":35,"utf16_col":9}},"extent_utf16":{"start":{"line_number":35,"utf16_col":0},"end":{"line_number":35,"utf16_col":44}}},{"name":"df_yellow","kind":"constant","ident_start":867,"ident_end":876,"extent_start":867,"extent_end":1026,"fully_qualified_name":"df_yellow","ident_utf16":{"start":{"line_number":38,"utf16_col":0},"end":{"line_number":38,"utf16_col":9}},"extent_utf16":{"start":{"line_number":38,"utf16_col":0},"end":{"line_number":40,"utf16_col":67}}},{"name":"common_colums","kind":"constant","ident_start":1029,"ident_end":1042,"extent_start":1029,"extent_end":1420,"fully_qualified_name":"common_colums","ident_utf16":{"start":{"line_number":43,"utf16_col":0},"end":{"line_number":43,"utf16_col":13}},"extent_utf16":{"start":{"line_number":43,"utf16_col":0},"end":{"line_number":62,"utf16_col":1}}},{"name":"df_green_sel","kind":"constant","ident_start":1424,"ident_end":1436,"extent_start":1424,"extent_end":1526,"fully_qualified_name":"df_green_sel","ident_utf16":{"start":{"line_number":66,"utf16_col":0},"end":{"line_number":66,"utf16_col":12}},"extent_utf16":{"start":{"line_number":66,"utf16_col":0},"end":{"line_number":68,"utf16_col":47}}},{"name":"df_yellow_sel","kind":"constant","ident_start":1528,"ident_end":1541,"extent_start":1528,"extent_end":1633,"fully_qualified_name":"df_yellow_sel","ident_utf16":{"start":{"line_number":70,"utf16_col":0},"end":{"line_number":70,"utf16_col":13}},"extent_utf16":{"start":{"line_number":70,"utf16_col":0},"end":{"line_number":72,"utf16_col":48}}},{"name":"df_trips_data","kind":"constant","ident_start":1636,"ident_end":1649,"extent_start":1636,"extent_end":1688,"fully_qualified_name":"df_trips_data","ident_utf16":{"start":{"line_number":75,"utf16_col":0},"end":{"line_number":75,"utf16_col":13}},"extent_utf16":{"start":{"line_number":75,"utf16_col":0},"end":{"line_number":75,"utf16_col":52}}},{"name":"df_result","kind":"constant","ident_start":1738,"ident_end":1747,"extent_start":1738,"extent_end":2561,"fully_qualified_name":"df_result","ident_utf16":{"start":{"line_number":80,"utf16_col":0},"end":{"line_number":80,"utf16_col":9}},"extent_utf16":{"start":{"line_number":80,"utf16_col":0},"end":{"line_number":104,"utf16_col":4}}}]}},"copilotInfo":null,"copilotAccessAllowed":false,"csrf_tokens":{"/DataTalksClub/data-engineering-zoomcamp/branches":{"post":"zNXvGUk91UUrfc2IJO1uvnILx4GOkpxrt3QeELvClQrFMhQu5X8xVbJdmmiNaUICe1_re29S1aVuxY19xMCohw"},"/repos/preferences":{"post":"5hpFhAQWhXEBD7oOi1FyF-7jbJHb6_oQgJjeoKMypIc3ELvOgxiHmkqKOi7cp7aC_XO0Ys5Cd1Otcnn1_a8OMQ"}}},"title":"data-engineering-zoomcamp/05-batch/code/06_spark_sql_big_query.py at main · DataTalksClub/data-engineering-zoomcamp"}